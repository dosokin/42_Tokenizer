var K=Object.defineProperty;var G=n=>{throw TypeError(n)};var W=(n,t,e)=>t in n?K(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var U=(n,t,e)=>W(n,typeof t!="symbol"?t+"":t,e),L=(n,t,e)=>t.has(n)||G("Cannot "+e);var r=(n,t,e)=>(L(n,t,"read from private field"),e?e.call(n):t.get(n)),F=(n,t,e)=>t.has(n)?G("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),E=(n,t,e,s)=>(L(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e),l=(n,t,e)=>(L(n,t,"access private method"),e);import{i as J,j as Q,k as _,l as x,m as H,n as X,t as tt,o as et,p as k,q as $,g as O,r as V,b as Y,c as nt,s as st}from"./popup-DYXlcu7j.js";const it=BigInt(-1),h=BigInt(0),I=BigInt(1),rt=BigInt(5),v={};let B="0000";for(;B.length<80;)B+=B;function b(n){let t=B;for(;t.length<n;)t+=t;return BigInt("1"+t.substring(0,n))}function A(n,t,e){const s=BigInt(t.width);if(t.signed){const i=I<<s-I;x(e==null||n>=-i&&n<i,"overflow","NUMERIC_FAULT",{operation:e,fault:"overflow",value:n}),n>h?n=k($(n,s),s):n=-k($(-n,s),s)}else{const i=I<<s;x(e==null||n>=0&&n<i,"overflow","NUMERIC_FAULT",{operation:e,fault:"overflow",value:n}),n=(n%i+i)%i&i-I}return n}function j(n){typeof n=="number"&&(n=`fixed128x${n}`);let t=!0,e=128,s=18;if(typeof n=="string"){if(n!=="fixed")if(n==="ufixed")t=!1;else{const c=n.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);_(c,"invalid fixed format","format",n),t=c[1]!=="u",e=parseInt(c[2]),s=parseInt(c[3])}}else if(n){const c=n,u=(d,g,q)=>c[d]==null?q:(_(typeof c[d]===g,"invalid fixed format ("+d+" not "+g+")","format."+d,c[d]),c[d]);t=u("signed","boolean",t),e=u("width","number",e),s=u("decimals","number",s)}_(e%8===0,"invalid FixedNumber width (not byte aligned)","format.width",e),_(s<=80,"invalid FixedNumber decimals (too large)","format.decimals",s);const i=(t?"":"u")+"fixed"+String(e)+"x"+String(s);return{signed:t,width:e,decimals:s,name:i}}function at(n,t){let e="";n<h&&(e="-",n*=it);let s=n.toString();if(t===0)return e+s;for(;s.length<=t;)s=B+s;const i=s.length-t;for(s=s.substring(0,i)+"."+s.substring(i);s[0]==="0"&&s[1]!==".";)s=s.substring(1);for(;s[s.length-1]==="0"&&s[s.length-2]!==".";)s=s.substring(0,s.length-1);return e+s}var m,o,f,a,y,p,C,M,R,z;const w=class w{constructor(t,e,s){F(this,a);U(this,"format");F(this,m);F(this,o);F(this,f);U(this,"_value");J(t,v,"FixedNumber"),E(this,o,e),E(this,m,s);const i=at(e,s.decimals);Q(this,{format:s.name,_value:i}),E(this,f,b(s.decimals))}get signed(){return r(this,m).signed}get width(){return r(this,m).width}get decimals(){return r(this,m).decimals}get value(){return r(this,o)}addUnsafe(t){return l(this,a,C).call(this,t)}add(t){return l(this,a,C).call(this,t,"add")}subUnsafe(t){return l(this,a,M).call(this,t)}sub(t){return l(this,a,M).call(this,t,"sub")}mulUnsafe(t){return l(this,a,R).call(this,t)}mul(t){return l(this,a,R).call(this,t,"mul")}mulSignal(t){l(this,a,y).call(this,t);const e=r(this,o)*r(t,o);return x(e%r(this,f)===h,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),l(this,a,p).call(this,e/r(this,f),"mulSignal")}divUnsafe(t){return l(this,a,z).call(this,t)}div(t){return l(this,a,z).call(this,t,"div")}divSignal(t){x(r(t,o)!==h,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),l(this,a,y).call(this,t);const e=r(this,o)*r(this,f);return x(e%r(t,o)===h,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),l(this,a,p).call(this,e/r(t,o),"divSignal")}cmp(t){let e=this.value,s=t.value;const i=this.decimals-t.decimals;return i>0?s*=b(i):i<0&&(e*=b(-i)),e<s?-1:e>s?1:0}eq(t){return this.cmp(t)===0}lt(t){return this.cmp(t)<0}lte(t){return this.cmp(t)<=0}gt(t){return this.cmp(t)>0}gte(t){return this.cmp(t)>=0}floor(){let t=r(this,o);return r(this,o)<h&&(t-=r(this,f)-I),t=r(this,o)/r(this,f)*r(this,f),l(this,a,p).call(this,t,"floor")}ceiling(){let t=r(this,o);return r(this,o)>h&&(t+=r(this,f)-I),t=r(this,o)/r(this,f)*r(this,f),l(this,a,p).call(this,t,"ceiling")}round(t){if(t==null&&(t=0),t>=this.decimals)return this;const e=this.decimals-t,s=rt*b(e-1);let i=this.value+s;const c=b(e);return i=i/c*c,A(i,r(this,m),"round"),new w(v,i,r(this,m))}isZero(){return r(this,o)===h}isNegative(){return r(this,o)<h}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return w.fromString(this.toString(),t)}static fromValue(t,e,s){const i=e==null?0:H(e),c=j(s);let u=X(t,"value");const d=i-c.decimals;if(d>0){const g=b(d);x(u%g===h,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),u/=g}else d<0&&(u*=b(-d));return A(u,c,"fromValue"),new w(v,u,c)}static fromString(t,e){const s=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);_(s&&s[2].length+s[3].length>0,"invalid FixedNumber string value","value",t);const i=j(e);let c=s[2]||"0",u=s[3]||"";for(;u.length<i.decimals;)u+=B;x(u.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),u=u.substring(0,i.decimals);const d=BigInt(s[1]+c+u);return A(d,i,"fromString"),new w(v,d,i)}static fromBytes(t,e){let s=tt(et(t,"value"));const i=j(e);return i.signed&&(s=k(s,i.width)),A(s,i,"fromBytes"),new w(v,s,i)}};m=new WeakMap,o=new WeakMap,f=new WeakMap,a=new WeakSet,y=function(t){_(this.format===t.format,"incompatible format; use fixedNumber.toFormat","other",t)},p=function(t,e){return t=A(t,r(this,m),e),new w(v,t,r(this,m))},C=function(t,e){return l(this,a,y).call(this,t),l(this,a,p).call(this,r(this,o)+r(t,o),e)},M=function(t,e){return l(this,a,y).call(this,t),l(this,a,p).call(this,r(this,o)-r(t,o),e)},R=function(t,e){return l(this,a,y).call(this,t),l(this,a,p).call(this,r(this,o)*r(t,o)/r(this,f),e)},z=function(t,e){return x(r(t,o)!==h,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),l(this,a,y).call(this,t),l(this,a,p).call(this,r(this,o)*r(this,f)/r(t,o),e)};let N=w;function ot(n,t){let e=18;return e=H(t,"unit"),N.fromValue(n,e,{decimals:e,width:512}).toString()}function ct(n,t){_(typeof n=="string","value must be a string","value",n);let e=18;return e=H(t,"unit"),N.fromString(n,{decimals:e,width:512}).value}function lt(n){return ot(n,18)}function xt(n){return ct(n,18)}const Z=async n=>{const t=await V();n||(n=dt());const e=await t.balanceOf(n);return lt(e)},dt=async()=>{const t=await Y().listAccounts();if(t.length!==0)return t[0].getAddress()};async function wt(n){const t=[],e=O(),s=await e.getFarmsIds();for(let i=0;i<s.length;i++){const c=(await e.farms(s[i])).toObject();c.owner===n&&t.push({...c,tokenId:s[i]})}return t}async function bt(n){const t=O(),e=await t.filters.BuildFarm(n);return await t.queryFilter(e)}function yt(n){const t=n.args.toObject();return{owner:t.owner,name:t.farmName,latitude:parseInt(t.latitude)/100,longitude:parseInt(t.longitude)/100}}let _t={lines:13,length:38,width:17,radius:45,scale:.2,corners:1,speed:1,rotate:0,animation:"spinner-line-fade-default",direction:1,color:"#ffffff",fadeColor:"transparent",top:"50%",left:"50%",shadow:"0 0 1px transparent",zIndex:2e9,className:"spinner",position:"absolute"};async function vt(n,t){const e=document.getElementById("popup");e.innerHTML=`<div class="m-auto flex flex-col gap-8 h-1/2 items-center w-1/2 justify-center">

        <div class="justify-between gap-3 flex flex-col inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] rounded-xl bg-neutral-900 w-full h-auto col-span-1 text-center  p-4 overflow-visible">

            <div class="flex flex-col w-full">
                <p class="text-4xl text-cyan-100 font-bold">You successfully purchased <span id="product-name"></span></p><br>
                <div class="flex flex-row w-full items-center justify-center">
                    <img id="product-img" src="" alt="product image" class="opacity-100 md:max-w-1/2"/>
                </div>
                <p class="text-4xl text-cyan-100 font-bold my-2">Thank you! Your belonging to the GRZ42 Project make the world better!</p>
            </div>
        </div>

    </div>`;const s=document.getElementById("product-img"),i=document.getElementById("product-name");i.innerText=n,s.setAttribute("src",t),e.classList.remove("hidden!"),e.addEventListener("click",()=>e.classList.add("hidden!"))}async function ut(n){const t=document.getElementById("popup");t.innerHTML=`<div class="m-auto flex flex-col gap-8 h-1/2 items-center 2xl:w-1/2 w-3/4 lg:2/3 justify-center">

        <div class="justify-between gap-3 flex flex-col inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] rounded-xl bg-neutral-900 w-full h-auto col-span-1 text-center  p-4 overflow-visible">

            <div class="flex flex-col w-full">
                <p class="text-4xl text-cyan-100 font-bold">You successfully minted <span id="product-name"></span></p><br>
                <div class="flex flex-col md:flex-row w-full">
                    <img id="product-img" src="" alt="product image" class="opacity-100 md:max-w-1/2"/>
                    <div class="text-white md:w-1/2 justify-between gap-3 flex flex-col inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] rounded-xl bg-neutral-900 h-full col-span-1 text-center  p-4 overflow-visible ">
                        <p id="metadata" class="text-lg text-cyan-100 font-bold break-words text-start"></p>
                    </div>
                </div>
                <p class="text-4xl text-cyan-100 font-bold my-2">Thank you! Your belonging to the GRZ42 Project make the world better!</p>
            </div>
        </div>

    </div>`;const e=document.getElementById("product-img"),s=document.getElementById("product-name");fetch("https://ipfs.io/ipfs/"+n.substring(7)).then(i=>i.json()).then(i=>{document.getElementById("metadata").innerText=JSON.stringify(i),s.innerText=i.name;const c="https://ipfs.io/ipfs/"+i.image.substring(7);e.setAttribute("src",c)}).catch(i=>console.log(i)),t.classList.remove("hidden!"),t.addEventListener("click",()=>t.classList.add("hidden!"))}const P=document.getElementById("user-access-container");function ft(){P.innerHTML='<button class="cursor-pointer! text-neutral-900 font-bold text-xl inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] flex md:flex-col rounded-xl bg-cyan-200 col-span-1 text-center justify-center p-4 items-center" id="metamaskConnection">CONNECT WITH METAMASK</button>',document.getElementById("metamaskConnection").addEventListener("click",async()=>{await nt()})}async function ht(n){const t=await Z(n);P.innerHTML=[`<a href='dashboard.html' class="cursor-pointer! text-neutral-900 font-bold text-xl inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] rounded-xl bg-cyan-200 col-span-1 text-center justify-center p-4 px-16 items-center" id="dashboardAccess">MY DASHBOARD</a>`,"   <a class='cursor-pointer! gap-1 flex flex-row text-neutral-900 font-bold text-xl inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] rounded-xl bg-cyan-200 col-span-1 text-center justify-center p-4 items-center' href='marketplace.html'>","       <img class='cursor-pointer! h-7 w-7' alt='shopping-cart' src='/shopping-cart.png'/>","   </a>",'<div class="gap-1 flex flex-row text-neutral-900 font-bold text-xl inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] rounded-xl bg-cyan-200 col-span-1 text-center justify-center p-4 items-center">',"   <img alt='wallet' class='h-7 w-7' src='/wallet.png' />",`    <p><span id="balance-header">${t}</span> $GRZ</p>`,"</div>"].join(`
`)}async function D(){const t=await Y().listAccounts();t.length===0?ft():t[0]!==T&&(T=t[0],await ht(T),await mt(T))}async function S(){const n=document.getElementById("balance-dashboard"),t=document.getElementById("balance-header"),e=await Z();t&&(t.innerText=e),n&&(n.innerText=e)}async function mt(n){const t=V(),e=O(),s=e.filters.BuildFarm(n),i=e.filters.Mint(n),c=t.filters.PurchaseProduct(n),u=t.filters.ClaimGrz(n);e.on(i,async d=>{const g=d.args.toObject();await S(),await ut(g.IPFSUrl)}),e.on(s,async d=>{await S()}),t.on(c,async d=>{await S()}),t.on(u,async d=>{const g=d.args.toObject();await S(),st(`You successfully redeemed ${g.amount} $GRZ42!`)})}let T=null;window.ethereum?(window.ethereum.on("accountsChanged",D),D()):P.innerHTML=`<a class="cursor-pointer! text-neutral-900 font-bold text-xl inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] flex md:flex-col rounded-xl bg-cyan-200 col-span-1 text-center justify-center p-4 px-16 items-center" id="dashboardAccess" href='https://chromewebstore.google.com/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn' target='_blank'>DOWNLOAD METAMASK</a>`;export{Z as a,wt as b,bt as c,vt as d,yt as e,dt as g,xt as p,_t as s};
