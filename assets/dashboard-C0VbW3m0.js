import{a as l,e as m,b as u,c as g,d as w}from"./popup-DYXlcu7j.js";import{S as p}from"./spin-CpXtSLqD.js";import{s as y,g as s,a as h,b as f}from"./header-CsDyQi8P.js";import{d as x}from"./metamask-CvptVMfk.js";import{c as I,a as E,d as b,e as B}from"./statistics-BxvZI_ps.js";async function T(){const t=await l();let n=document.getElementById("airdrop"),a=new p(y).spin(n);try{await(await t.claimGrz()).wait()}catch(e){m(e.reason)}a.stop()}let o=null;const k=async()=>{const t=await g(),n=await h(t);document.getElementById("balance-dashboard").innerText=n,document.getElementById("balance-header").innerText=n,document.getElementById("connected-address").innerText=await t.getAddress()},r=async()=>{const t=await u().listAccounts();t.length===0?window.location.replace("connection.html"):o!==t[0]&&(o=t[0],await k())};async function A(){const t=await s(),n=await I(t),a=await E();document.getElementById("farms-count").innerText=String(n),document.getElementById("crickets-count").innerText=String(a),document.getElementById("meals-count").innerText=String(Math.round(a/77)),document.getElementById("farmer-rank").innerText=await b(t)}window.ethereum?(window.ethereum.on("accountsChanged",r),r(),document.getElementById("disconnect").addEventListener("click",x),document.getElementById("airdrop").addEventListener("click",T),A()):window.location.replace("connection.html");async function _(){const t=document.getElementById("owned-farms"),n=await s();(await f(n)).forEach(async e=>{const c=new Date(parseInt(e.buildTime)*1e3),d=[c.getDate(),c.getMonth(),c.getFullYear()].join("/"),i=await B(e.buildTime);t.innerHTML+=['<tr class="text-center">',`<td class="py-3">${d}</td>`,`<td><a target="_blank" href="https://testnets.opensea.io/assets/sepolia/${w}/${e.tokenId}" class="p-1 cursor-pointer! text-neutral-900 font-bold text-xl inset-shadow-[0_0_12px_cyan] shadow-[0_0_20px_cyan] hover:shadow-[0_0_30px_cyan] flex md:flex-col rounded-xl bg-cyan-200 col-span-1 text-center justify-center items-center">${e.name}</a></td>`,`<td>(${parseInt(e.latitude)/100}, ${parseInt(e.longitude)/100})</td>`,`<td>${i}</td>`,"</tr>"].join("")})}window.ethereum&&_();
